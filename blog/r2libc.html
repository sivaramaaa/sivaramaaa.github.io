<html>
 <head>
<title> r2libc  </title>
	 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
</head>
<style>
.top {
		background:
		radial-gradient(black 15%, transparent 16%) 0 0,
		radial-gradient(black 15%, transparent 16%) 8px 8px,
		radial-gradient(rgba(255,255,255,.1) 15%, transparent 20%) 0 1px,
		radial-gradient(rgba(255,255,255,.1) 15%, transparent 20%) 8px 9px;
	background-color:#282828;
	background-size:16px 16px;
		width:100%;
		height:30%;
	}

      body {background-color:white;
	border-bottom:1px solid #bfbfbf
         line-height:1.5em;
	color:#222}

</style>
<body>
	
<div class = "top"></div>         

<h1 class="post-title"> Return to libc exploit </h1>

<div id="doc" class="markdown-body container-fluid comment-enabled" style="position: relative;"><h2 id="Return-to-libc-exploit">Return to libc exploit</h2><p>We use this to bypass NX (Non-executable stack)</p><p>The concept here is we overflow our buffer till eip then in eip we give system() -address that is libc then next four byte is dummy the next four byte is ‘/bin/sh’ adress</p><p>so our payload looks like this : Overflow_till_eip+System() {address} + “DUMMY”+&amp;{’/bin/sh’}</p><p><strong>Note:</strong> In this problem the input is got through read(), so u have to add ;cat to ur payload and u wont be able to see $ symbol in shell but still it’s shell :)</p><p><img src="https://raw.githubusercontent.com/sivaramaaa/sivaramaaa.github.io/master/images/r2libc.png" alt=""></p><h4 id="Revisting-after-2-years">Revisting (after 2 years)</h4><ul>
<li>X86 32 bit calling convention explained!</li>
</ul><p><img src="https://raw.githubusercontent.com/sivaramaaa/sivaramaaa.github.io/master/images/IMG_20181215_135437__01.jpg" alt="1"></p><p><img src="https://raw.githubusercontent.com/sivaramaaa/sivaramaaa.github.io/master/images/IMG_20181215_135445.jpg" alt="2"></p><ul>
<li>Reason for adding “dummy” in between<br>
<img src="https://raw.githubusercontent.com/sivaramaaa/sivaramaaa.github.io/master/images/IMG_20181215_135458__01.jpg" alt="final"></li>
</ul><h4 id="Reference">Reference</h4><p><a href="https://www.exploit-db.com/docs/english/28553-linux-classic-return-to-libc-&amp;-return-to-libc-chaining-tutorial.pdf" target="_blank" rel="noopener">exploit-db article</a></p></div>

</body>
</html>
